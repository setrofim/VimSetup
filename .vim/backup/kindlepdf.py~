#!/usr/bin/env python
import sys
from pyPdf import PdfFileReader

def print_pdf_structure(pdfobject, indent=0, done=[]):
    if hasattr(pdfobject, "keys"):
        for key in pdfobject.keys():
            print "    " * indent, key, ":", pdfobject[key]
            if not str(pdfobject[key]) in done:
                done.append(str(pdfobject[key]))
                obj = pdfobject[key].getObject()
                print_pdf_structure(obj, indent+1, done)
    else:
        try:
            for entry in pdfobject:
                if not str(entry) in done:
                    done.append(str(entry))
                    print_pdf_structure(entry.getObject(), indent+1, done)
        except TypeError: # not iterable
            pass

with open(sys.argv[1]) as fh:
    pdfdoc = PdfFileReader(fh)
    print_pdf_structure(pdfdoc.trailer)
